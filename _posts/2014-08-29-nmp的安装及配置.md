---
layout: post
title: nmp的安装及配置
category: experience
---
从最开始在windows上配置amp（wamp:windwos+apache+mysql+php），到在linux上配置amp（lamp:linux+apache+mysql+php）,到现在在linux上配置nmp（lnmp:linux+nginx+mysql+php）,虽然换汤不换药，但是因为毕竟这不是能便于理解或是形成肌肉记忆的东西。所以每次配置的时候都有磕磕绊绊的情况，一些细节总是记不住。所以写在这里，以备后用。`这里所记录的方式都是简单的安装方式，并没有用make的方式进行安装，仅仅是为了简约，如果你有更高级的方法，请也不要鄙夷！`

![](/img/self/nginx.jpg)

<h1>nginx的安装和配置</h1>
<h2>安装nginx</h2>

* sudo apt-get update (先更新一下源)
* sudo apt-get install nginx (安装nginx)

<h2>配置nginx并做简单测试</h2>

* mkdir -p /data/code/www.test.com (创建静态页面文件夹)
* vim /data/code/www.test.com/index.html 并在里面写上

		<html>this is www.test.com</html>
	
类似的html。

* cp /etc/nginx/sites-available/default /etc/nginx/sites-available/www.test.com 并修改www.test.com文件

把server的结点改成这个样子

		server {
			#listen 80 default_server;
			listen 80;
			#listen [::]:80 default_server ipv6only=on;

			root /data/code/www.test.com;
			index index.html index.htm;

			# Make site accessible from http://localhost/
			server_name www.test.com;
		
* ln -s /etc/nginx/sites-available/www.test.com /etc/nginx/sites-enabled/www.test.com (从available到enabled建立软连接)
* sudo service nginx restart (重启nginx)
* sudo vim /etc/hosts （修改hosts文件，要做www.test.com的本地映射）

		127.0.0.1   www.test.com
	
然后打开浏览器访问www.test.com ,应该能看到this is www.test.com即你刚刚写的html。说明nginx安装并配置成功

<h1>mysql的安装和配置</h1>
<h2>安装mysql</h2>
* sudo apt-get install mysql-server mysql-client （这里会让你输入root用户的password ， 请一定记牢）

<h2>搭建mysql数据库实例</h2>
一般情况下，从头开始create database，然后建立表格并填充里面的数据的都是项目的初期。过了这个时期的话，就要从某个环境dump出来sql然后在restore到本地了。

* mysqldump -h [服务器ip] -u[数据库用户名] -p[密码] [数据库名称] > /tmp/***.sql（从某个环境上dump数据，别忘记copy到本地）
* mysql -h 127.0.0.1 -uroot -p (连接本地的数据库，然后create database [数据库名称] 创建本地的数据库实例)
* mysql -h 127.0.0.1 -uroot -p --default-character-set=utf8 [数据库名称] < 本地***.sql (填充数据，耐心一会)

<h1>php的安装和配置</h1>
<h2>安装php及对应的组件</h2>

* sudo apt-get install php5-fpm php5-gd php5-redis php5-curl (安装php5-fpm 及其他模块,具体module看你的需求)

<h2>配置php及fastcgi</h2>	

* vim /data/code/www.test.com/test.php

		<?php phpinfo(); ?>

* sudo vim /etc/php5/fpm/pool.d/www.conf （修改php5-fpm里面的监听接口）

原来可能是listen = /var/run/php5-fpm.sock 将这行注释然后写

		listen = 127.0.0.1:9000

fastcgi 守护进程配置的TCP socket地址是本机，端口是9000

* sudo vim /etc/nginx/sites-available/www.test.com （将nginx的php节点配置成以下的内容）

		location ~ \.php$ {
					#       fastcgi_split_path_info ^(.+\.php)(/.+)$;
					#       # NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini
									fastcgi_pass 127.0.0.1:9000;
					#       # With php5-fpm:
					#       fastcgi_pass unix:/var/run/php5-fpm.sock;
					#       fastcgi_index index.php;
									include fastcgi_params;
					}

然后打开浏览器访问www.test.com/test.php 你可以看到本机的php的环境变量,即说明php安装并配置成功


