---
layout: post
title: msysgit使用
category: thinking
---
版本管理用过很多，最初的什么VSS、TFS、SD（Source Dept）就不提了，年代久远，不提也罢。近几年用的版本管理工具从SVN到mercurial，再到git。才感觉到git才是功能强大啊。

关于github在windows上的使用，这篇文章就来简单的介绍一下。

##在windows上安装msysgit##

![](http://writehappy.qiniudn.com/img/msysgit.png)

话不多说，下载下来之后，下一步下一步即可！

##生成密钥对##

	ssh-keygen -t rsa -C "youemail@example.com"
	
这里最好不要输入密码， 以后如果忘记密码的话就会很麻烦
按照默认的，会在用户家目录下创建.ssh文件夹， 里面存放id_rsa私钥和id_rsa_pub公钥
然后把公钥的内容添加到github里面 （登陆www.github.com 然后在account setting -> SSH keys里面设置  ）

##测试密钥对是否成功##
	ssh -T git@github.com （只是测试密钥对是否成功）

##设置账号信息##
	git config --global user.name "github上的用户名"
	git config --global user.email "注册github的邮箱"

当设置完之后， 其实会发现在用户家目录下多了一个.gticonfig文件 里面存储着

	[user]
		name = "github上的用户名"
		email = "注册github的邮箱"
			 
这样的信息，用<code>git config --list</code>可以看到当前的配置， 其中就包括了user.name  和user.email

#git的使用#
下面写的东西严格来说不是msysgit的内容，而就是git的使用。

##clone一个repository试试看##
	git clone https://github.com/SomeUser/project.git  （走https协议）
	git clone git@github.com:SomeUser/project.git   (走ssh协议)

在你clone之后，git会自动将远程仓库remote repository命名为origin，其实它就是一个别名。
	
##查看git remote repository##
	git remote -v （相当于mercurial里面的hg path，不同的是水银的pull和push是一个repository，而git可以是两个，即可以从a上fetch，本地修改之后，push到b上）

运行命令git remote -v 或者查看.git/config,你也能明白origin的含义。	

##切换分支##
	git checkout [branch_name]
	
##创建分支##
	git branch [new_branch] （如果只是git brahch 就是列出已经存在的分支）

##查看分支##

	git branch -a (to show all the branches git knows about)
	结果比如：
	*master
	remotes/origin/HEAD -> origin/master
	remotes/origin/master

master是本地的一个分支，而且目前只有这么一个分支
	
##pull##
真的不知道怎么把pull翻译成中文，理解就行了
	git pull （相当于 git pull [repository_name] [local_branch_name]）
	
当然git pull和git fetch是有区别的：

	git pull origin master
	
相当于
	
	git fetch origin master
	git merge origin/master
	
首先从远程的origin的master主分支下载最新的版本到origin/master分支上,然后进行合并。如果写的再啰嗦一点就是

	git fetch origin master:temp
	git diff temp
	git merge temp

即从远程的origin这个reposigory的master分支上获取最新版本到本地的temp分支，然后比较远程master和本地temp的区别，最后进行远程master和本地temp的merge

##git add ##
	git add <file> 或者 git add --all或者git add -i

当你本地修改完文件，在commit之前，要记得将更改的文件add一下。

建议是git add -i ,在what now之后选择u(update)或者选择p(patch)这个还是比较有用的，可以自己去探索一下，被track的文件都会加上*号，参考http://www.cnblogs.com/mengdd/archive/2013/04/11/3013843.html

当然也可以用add file，不过如果文件名是中文但是终端编码不支持的话，就比较麻烦；如果本地没有杂七杂八的其他文件也可以git add --all

##git commit##
	git commit -m "当次提交的comments"
	
如果已经commit了，然后此时不想push ， 还想对它进行修改再push。那么可以<code>git reset --hard [再之前的那次commit_id]</code> (回到更早之前的版本，然后再重新修改 再提交)

	git reset --hard [commit_id]

##git diff##

	git diff origin/master master

当你本地commit了之后，可以用这个来查看本地的master分支和origin的master分支的区别。

##放弃单个文件的修改##
	git checkout [文件名]
	
如果想让文件回到指定版本，可以

	git reset [commit_id] [文件名]
	
##git push##
	git push origin master (origin指定了你要push到哪个remote repository)
	
master其实是一个“refspec”,refspec 是reference specification，就是具体的引用的意思。

其实是一种格式，正常的格式是可选的+号，接着是`<src>:<dst>`，冒号前表示local branch的名字，冒号后表示remote repository下 branch的名字。

注意，如果你省略了<dst>，git就认为你想push到remote repository下和local branch相同名字的branch。
听起来有点拗口，再解释下，push是怎么个push法，就是把本地branch指向的commit push到remote repository下的branch。
比如

	$git push origin (最常见的玩法，表示将本地当前的分支推送到origin对应的分支)
	$git push    	 (如果remote repository有且只有一个分支，这种情况下，git push表示将local的branch推送到origin唯一的那个分支上)
	$git push origin master:master (在local repository中找到名字为master的branch，使用它去更新remote repository下名字为master的branch，如果remote repository下不存在名字是master的branch，那么会新建一个)
	$git push origin master （省略了<dst>，等价于“git push origin master:master”，表示将本地的master分支推送到origin的master分支）
	$git push origin master:refs/for/mybranch (在local repository中找到名字为master的branch，用他去更新remote repository下面名字为mybranch的branch)
	$git push origin HEAD:refs/for/mybranch （HEAD指向当前工作的branch，master不一定指向当前工作的branch，所以我觉得用HEAD还比master好些）
	$git push origin :mybranch （在origin repository里面查找mybranch，删除它。用一个空的去更新它，就相当于删除了）
	
##git remote##
	git remote add orgin ssh://git@github.com/user/project.git
	
相当于origin是远程仓库ssh://git@github.com/user/project.git的一个别名

##git config##

	git config --list （能看到remote.origin.url 那么想当于hg path，就是查看remote repository的路径。当然，git config本身的功能要比hg path丰富多了）

##create a new repository on the command line##
首先在github上用web UI的方式创建一个新的repository，然后剩下的就是本地操作了，
一定记得要在事先创建好的干净的路径下操作！

	touch README.md
	git init
	git add README.md
	git commit -m "first commit"
	git remote add origin git@github.com:[user]]/[repository]].git
	git push -u origin master (-u其实是--set-upstream)

github上说这样就可以用command line的方式创建repository

但其实仅仅git clone个人觉得也是可以的。

	git clone git@github.com:[user]]/[repository]].git

总结：对git的操作是围绕3个大的东西来展开的（其实几乎所有的SCM都是这样）

	1.     从git取数据（git clone）
	2.     改动代码
	3.     将改动传回git（git push）

这3个步骤又涉及到两个repository，一个是remote repository，在远程服务器上，一个是local repository，在自己工作区上。

不管做什么操作，明白这些会有很大的帮助。
